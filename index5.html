<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Red de Recursos</title>

<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<style>
body{font-family:system-ui;background:#f8fafc;margin:0}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:2rem;padding:2rem}
.card{background:#fff;border-radius:1.5rem;border:1px solid #e5e7eb;cursor:pointer}
.card img{width:100%;height:180px;object-fit:contain}
.card-content{padding:1.25rem}

.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.4);display:flex;align-items:center;justify-content:center;z-index:50}
.modal{background:#fff;width:100%;max-width:1100px;border-radius:1.5rem;overflow:hidden;max-height:90vh;overflow-y:auto}

.modal-banner{height:320px;background:#f1f5f9}
.modal-banner img{width:100%;height:100%;object-fit:cover}

.modal-body{padding:2rem}
.section{margin-bottom:2rem}
.section h4{text-transform:uppercase;font-size:.75rem;color:#64748b;margin-bottom:.5rem}

.attachments a, .contact a{
display:block;
padding:.75rem 1rem;
border:1px solid #c7d2fe;
border-radius:.75rem;
margin-bottom:.5rem;
text-decoration:none;
color:#4338ca;
font-weight:600;
}

.close{
position:absolute;
top:1rem;
right:1rem;
background:#fff;
border:none;
border-radius:50%;
width:40px;
height:40px;
cursor:pointer;
}
</style>
</head>

<body>
<div id="root"></div>

<script type="text/babel">
const API_URL = "https://script.google.com/macros/s/AKfycby2gx98de1w3wqdn4wroCe-nl9istqFB7i0uqjC3IuxOkm8M2i-kNG4QJoZ9_49y6Th5A/exec";

function App(){
  const [data,setData]=React.useState([]);
  const [selected,setSelected]=React.useState(null);

  React.useEffect(()=>{
    fetch(API_URL).then(r=>r.json()).then(setData);
  },[]);

  return (
    <>
      <div className="grid">
        {data.map(r=>(
          <div className="card" key={r.id} onClick={()=>setSelected(r)}>
            <img src={r.imagenUrl}/>
            <div className="card-content">
              <h3>{r.titulo}</h3>
              <small>{r.entidad}</small>
            </div>
          </div>
        ))}
      </div>

      {selected && (
        <div className="modal-overlay" onClick={()=>setSelected(null)}>
          <div className="modal" onClick={e=>e.stopPropagation()}>
            <button className="close" onClick={()=>setSelected(null)}>‚úï</button>

            <div className="modal-banner">
              <img src={selected.imagenUrl}/>
            </div>

            <div className="modal-body">
              <h1>{selected.titulo}</h1>
              <p><strong>{selected.entidad}</strong></p>

              <div className="section">
                <h4>Descripci√≥n</h4>
                <p>{selected.descripcion}</p>
              </div>

              {selected.adjuntos.length>0 && (
                <div className="section attachments">
                  <h4>Documentos adjuntos</h4>
                  {selected.adjuntos.map(a=>(
                    <a key={a.url} href={a.url} target="_blank">{a.nombre}</a>
                  ))}
                </div>
              )}

              <div className="section contact">
                <h4>Contacto</h4>
                {selected.entityPhone && <a href={`tel:${selected.entityPhone}`}>üìû {selected.entityPhone}</a>}
                {selected.entityEmail && <a href={`mailto:${selected.entityEmail}`}>‚úâÔ∏è {selected.entityEmail}</a>}
                {selected.entityAddress && <a>üìç {selected.entityAddress}</a>}
              </div>

              <a href={selected.enlace} target="_blank" className="attachments a">
                Ir al sitio web del recurso
              </a>
            </div>
          </div>
        </div>
      )}
    </>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<App/>);
</script>
</body>
</html>
